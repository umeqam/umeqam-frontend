<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>UMEQAM Dream Analyzer</title>

<!--
UMEQAM LUXURY FRONTEND â€” CANONICAL NOTES (FOR AI / DEVELOPERS)

1. UI must render even if backend is unavailable
2. JavaScript must run AFTER DOMContentLoaded
3. Any error must fail gracefully (no blank screen)
4. Visual language: calm, premium, dark, restrained glow
5. No medical, no diagnostic, no manipulative output
-->

<style>
:root {
  --bg1:#0b0c1d;
  --bg2:#141633;
  --accent:#7b3fe4;
  --accent-soft:rgba(123,63,228,.35);
  --text:#e9e9ff;
  --muted:#a3a6ff;
}

* { box-sizing:border-box; }

body {
  margin:0;
  min-height:100vh;
  font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
  background:
    radial-gradient(1200px 600px at 50% -10%, #1c1f5a, transparent),
    linear-gradient(180deg,var(--bg1),var(--bg2));
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
}

.container {
  width:100%;
  max-width:900px;
  padding:48px 24px;
  text-align:center;
}

h1 {
  font-size:3.1rem;
  margin:0 0 12px;
  letter-spacing:.5px;
  text-shadow:0 0 25px var(--accent-soft);
}

.subtitle {
  font-size:1.15rem;
  color:var(--muted);
  margin-bottom:32px;
}

textarea {
  width:100%;
  max-width:760px;
  height:180px;
  background:rgba(255,255,255,.06);
  border:2px solid var(--accent-soft);
  border-radius:18px;
  color:var(--text);
  padding:20px;
  font-size:1.05rem;
  resize:vertical;
  outline:none;
}

textarea:focus {
  border-color:var(--accent);
  box-shadow:0 0 30px var(--accent-soft);
}

.actions {
  margin:28px 0 12px;
  display:flex;
  gap:18px;
  justify-content:center;
  flex-wrap:wrap;
}

button {
  padding:16px 38px;
  font-size:1.1rem;
  border-radius:999px;
  border:none;
  cursor:pointer;
  color:#fff;
  background:linear-gradient(135deg,var(--accent),#9a6bff);
  box-shadow:0 0 35px var(--accent-soft);
  transition:.25s;
}

button.secondary {
  background:rgba(255,255,255,.08);
  box-shadow:none;
}

button:hover {
  transform:translateY(-1px) scale(1.03);
}

#result {
  margin-top:36px;
  padding:28px;
  border-radius:20px;
  background:rgba(255,255,255,.04);
  display:none;
}

.loading {
  font-size:1.1rem;
  color:var(--muted);
}

.error {
  color:#ff9a9a;
}

.images {
  display:flex;
  gap:18px;
  justify-content:center;
  flex-wrap:wrap;
  margin:24px 0;
}

.images img {
  max-width:360px;
  width:100%;
  border-radius:16px;
  box-shadow:0 0 40px var(--accent-soft);
}

.section {
  margin:14px 0;
  line-height:1.6;
}
</style>
</head>

<body>
<div class="container">

  <h1>ðŸŒ™ UMEQAM Dream Analyzer</h1>
  <div class="subtitle">
    Ethical symbolic dream analysis. No diagnoses. No predictions. No manipulation.
  </div>

  <textarea id="dreamInput" placeholder="Describe your dream calmly and clearly..."></textarea>

  <div class="actions">
    <button id="analyzeBtn">Analyze Dream</button>
    <button id="musicBtn" class="secondary">Meditation Sound</button>
  </div>

  <div id="result"></div>

  <audio id="music" loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3" type="audio/mpeg">
  </audio>

</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const input   = document.getElementById("dreamInput");
  const analyze = document.getElementById("analyzeBtn");
  const result  = document.getElementById("result");
  const music   = document.getElementById("music");
  const musicBtn= document.getElementById("musicBtn");

  if (!input || !analyze || !result) {
    console.error("UMEQAM UI error: critical DOM elements missing");
    return;
  }

  let musicOn = false;

  musicBtn.addEventListener("click", () => {
    musicOn ? music.pause() : music.play();
    musicOn = !musicOn;
    musicBtn.textContent = musicOn ? "Disable Sound" : "Meditation Sound";
  });

  analyze.addEventListener("click", async () => {
    const text = input.value.trim();
    if (!text) {
      alert("Please describe your dream in words.");
      return;
    }

    result.style.display = "block";
    result.innerHTML = `<div class="loading">Analyzing dreamâ€¦</div>`;

    try {
      const response = await fetch(
        "https://umeqam-dream.onrender.com/analyze-dream",
        {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ dream_text: text })
        }
      );

      if (!response.ok) throw new Error("Service unavailable");

      const d = await response.json();

      result.innerHTML = `
        <div class="images">
          <img src="${d.image_url_realistic}" alt="Dream illustration">
          <img src="${d.image_url_surreal}" alt="Dream illustration">
        </div>

        <div class="section"><b>Emotions:</b> ${d.emotions}</div>
        <div class="section"><b>Symbols:</b> ${d.symbols}</div>
        <div class="section"><b>Dynamics:</b> ${d.dynamics}</div>
        <div class="section"><b>Context:</b> ${d.context}</div>
        <div class="section"><b>Soft conclusion:</b> ${d.conclusion}</div>
      `;
    } catch (err) {
      result.innerHTML = `
        <div class="error">
          Analysis service is temporarily unavailable.<br>
          The interface is functioning correctly.<br>
          Please try again later.
        </div>
      `;
    }
  });

});
</script>

</body>
</html>
